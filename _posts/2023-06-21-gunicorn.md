---
layout: post
title: "Gunicorn from scratch"
date: 2023-06-21
published: false
author: victor
tags:
  - gunicorn
  - basics
categories:
  - Production deployment
---

Gunicorn stands for ‘Green Unicorn’ and is a Python WSGI HTTP Server for UNIX. 
It receives the request from the client, passes it to the (django) application and then sends the response returned by the application to the client.

You can spawn multiple gunicorn processes that will serve your application to make use of the computing power of your server, based on the number of CPUs the machine has.

To find out the number of processors on your UNIX machine, you can execute [`grep -c ^processor /proc/cpuinfo`](https://stackoverflow.com/questions/6481005/how-to-obtain-the-number-of-cpus-cores-in-linux-from-the-command-line).


Gunicorn suggests to run `2-4 x $(NUM_CORES)` of workers <sup>[1](https://docs.gunicorn.org/en/stable/settings.html#workers)<sup>.

```
.
├── manage.py
├── gunicorn.conf.py    <--- create here
└── project
    ├── __init__.py
    ├── asgi.py
    ├── settings.py
    ├── urls.py
    └── wsgi.py
```


Create a file called `gunicorn.conf.py`

```python
import multiprocessing

bind = "127.0.0.1:8000"
workers = multiprocessing.cpu_count() * 2 + 1
```

Call `gunicorn project.wsgi:application` will spawn one parent process and a number of child processes that coincide with the number of workers.

To run this process in the background, you need to configure Supervisor or Systemd.

You can set 
```python
bind = "unix:/home/sammy/myproject/myproject.sock"
```

*WSGI*: stands for *Web Server Gateway Interface*. It is an interface specification by which server and application communicate. 

## Further Reading
* [Gunicorn Docs][gunicorn]
* [How To Set Up Django with Postgres, Nginx, and Gunicorn on Ubuntu 16.04](digitalocean)
* [simpleisbetterthancomplex.com](simpleisbetterthancomplex)
* [WSGI Servers][fullstackpython]

[wsgi]: https://wsgi.readthedocs.io/en/latest/
[gunicorn]: https://docs.gunicorn.org/en/stable/index.html
[simpleisbetterthancomplex]: https://simpleisbetterthancomplex.com/series/2017/10/16/a-complete-beginners-guide-to-django-part-7.html
[digitalocean]: https://www.digitalocean.com/community/tutorials/how-to-set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-16-04
[fullstackpython]: https://www.fullstackpython.com/wsgi-servers.html
https://technikamateur.de/server/gunicorn-3-mit-systemd-nginx-einrichten
